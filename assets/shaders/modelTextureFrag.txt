#version 330 core

in vec2 texCoord;
uniform sampler2D texture0;
out vec4 FragColor;

in vec4 position;
vec3 lightMultiplier = vec3(1.0f);
uniform vec3 lightPos = vec3(0.0f);
uniform float lightIntensity = 1.0f;
uniform float lightRadius = 40.0f;
uniform bool useLight = true;
uniform float lowestLight = 0.0f;

uniform bool cameraInWater = false;
uniform vec3 waterMultiplyColour = vec3(1.0f);

uniform vec3 multiplyColour = vec3(1.0f);

void main(){
	vec3 usedPosition = vec3(position.x, 0.0f, position.z);
        float distance = distance(usedPosition, lightPos);
	float multiply = (1.0f - (distance / lightRadius)) * lightIntensity;
	if(multiply < lowestLight){
		multiply = lowestLight;
	}

	if(useLight) { lightMultiplier = vec3(multiply); }
	if(!useLight) { lightMultiplier = vec3(1.0f); }

    FragColor = texture(texture0, texCoord);;
    FragColor = FragColor * vec4(multiplyColour, 1.0f);
    if(cameraInWater){
	if(position.y < 0.0f){
	    FragColor = FragColor * vec4(waterMultiplyColour, 1.0f);
	}
    }
    FragColor = FragColor * vec4(lightMultiplier, 1.0f);
}